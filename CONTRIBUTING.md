# xcal é¡¹ç›®è´¡çŒ®æŒ‡å—

æ¬¢è¿å‚ä¸ xcal é¡¹ç›®çš„å¼€å‘ï¼xcal æ˜¯ä¸€ä¸ª C++ å›¾å½¢æ¸²æŸ“åº“ï¼Œæœ¬æ–‡æ¡£å°†æŒ‡å¯¼æ‚¨å¦‚ä½•ä¸ºé¡¹ç›®åšå‡ºè´¡çŒ®ã€‚

## ç›®å½•
- [å¼€å‘ç¯å¢ƒè®¾ç½®](#å¼€å‘ç¯å¢ƒè®¾ç½®)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [æ„å»ºæŒ‡å—](#æ„å»ºæŒ‡å—)
- [ä»£ç é£æ ¼](#ä»£ç é£æ ¼)
- [æäº¤è´¡çŒ®æµç¨‹](#æäº¤è´¡çŒ®æµç¨‹)
- [æµ‹è¯•è¦æ±‚](#æµ‹è¯•è¦æ±‚)
- [æ–‡æ¡£è¦æ±‚](#æ–‡æ¡£è¦æ±‚)
- [é—®é¢˜æŠ¥å‘Š](#é—®é¢˜æŠ¥å‘Š)

## å¼€å‘ç¯å¢ƒè®¾ç½®

### ç¼–è¯‘å™¨è¦æ±‚
- **ç¼–è¯‘å™¨**: 
  - Windows: Clang-cl 19.1.0
  - Linux: Clang 19.1+
- **C++æ ‡å‡†**: C++23
- **æ„å»ºç³»ç»Ÿ**: CMake 3.15+

### ä¾èµ–é¡¹

- **GLFW3**: çª—å£ç®¡ç†å’Œ OpenGL ä¸Šä¸‹æ–‡åˆ›å»º
- **æ¸²æŸ“åç«¯** (äºŒé€‰ä¸€):
  - **glbinding**: OpenGL å‡½æ•°ç»‘å®šåº“
  - **glad**: OpenGL å‡½æ•°åŠ è½½åº“
- **ZeroMQ**: å¼‚æ­¥æ—¥å¿—æ”¯æŒ (é€šè¿‡ cppzmq)
- **JSON**: æ—¥å¿—æ¶ˆæ¯æ ¼å¼åŒ– (é€šè¿‡ nlohmann_json)
- **xcmath**: å†…éƒ¨æ•°å­¦è¿ç®—åº“
- **xclogger**: å†…éƒ¨æ—¥å¿—ç³»ç»Ÿ

## é¡¹ç›®ç»“æ„

### æ ¸å¿ƒæ¨¡å—
- **mobject**: å›¾å½¢å¯¹è±¡æ¨¡å—ï¼ˆæ ¸å¿ƒæŠ½è±¡ï¼‰
- **scene**: åœºæ™¯ç®¡ç†æ¨¡å—  
- **render**: æ¸²æŸ“å¼•æ“æ¨¡å—ï¼ˆOpenGL/GLFWï¼‰
- **property**: å±æ€§ç³»ç»Ÿï¼ˆä½ç½®ã€é¢œè‰²ã€æ ‡é‡ã€æ—¶é—´ã€å‘é‡ç­‰ï¼‰
- **camera**: ç›¸æœºç³»ç»Ÿï¼ˆæ­£äº¤ç›¸æœºã€é€è§†ç›¸æœºï¼‰
- **animation**: åŠ¨ç”»ç³»ç»Ÿæ¨¡å—

### æ–‡ä»¶ç»“æ„
```
xcal/
â”œâ”€â”€ xcal/                 # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ animation/        # åŠ¨ç”»ç³»ç»Ÿæ¨¡å—
â”‚   â”œâ”€â”€ camera/           # ç›¸æœºç³»ç»Ÿæ¨¡å—
â”‚   â”œâ”€â”€ mobject/          # å›¾å½¢å¯¹è±¡æ¨¡å—
â”‚   â”œâ”€â”€ property/         # å±æ€§ç³»ç»Ÿæ¨¡å—
â”‚   â”œâ”€â”€ render/           # æ¸²æŸ“å¼•æ“æ¨¡å—
â”‚   â”œâ”€â”€ scene/            # åœºæ™¯ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ public.h          # å…¬å…±å¤´æ–‡ä»¶
â”‚   â””â”€â”€ main.cc           # åº”ç”¨ç¨‹åºå…¥å£ç‚¹
â”œâ”€â”€ tests/                # æµ‹è¯•ç›®å½•
â”œâ”€â”€ third_party/          # ç¬¬ä¸‰æ–¹ä¾èµ–
â”œâ”€â”€ res/                  # èµ„æºæ–‡ä»¶
â”œâ”€â”€ tools/                # å·¥å…·è„šæœ¬
â””â”€â”€ CMakeLists.txt        # ä¸»æ„å»ºé…ç½®
```

### å…³é”®æ–‡ä»¶è¯´æ˜
- **æ ¸å¿ƒå¤´æ–‡ä»¶**: `public.h` (åŸºç¡€ç±»å‹å’Œæ—¥å¿—é…ç½®), `main.cc` (åº”ç”¨ç¨‹åºå…¥å£ç‚¹)
- **åŠ¨ç”»ç³»ç»Ÿ**: `animation/core/abs_animation.hpp` (æŠ½è±¡åŠ¨ç”»åŸºç±»)
- **ç›¸æœºç³»ç»Ÿ**: æ­£äº¤ç›¸æœºã€é€è§†ç›¸æœºå®ç°å’ŒæŠ½è±¡åŸºç±»
- **å›¾å½¢å¯¹è±¡**: åœ†å½¢ã€çŸ©å½¢ã€çº¿æ¡ã€å¤šè¾¹å½¢ã€æ¤­åœ†ã€è·¯å¾„ç­‰å…·ä½“å¯¹è±¡
- **å±æ€§ç³»ç»Ÿ**: ä½ç½®ã€é¢œè‰²ã€æ ‡é‡ã€æ—¶é—´ã€å‘é‡ç­‰å±æ€§å®ç°
- **åœºæ™¯ç®¡ç†**: åœºæ™¯æ¥å£å’Œå…·ä½“å®ç°
- **æ¸²æŸ“å¼•æ“**: OpenGL æ¸²æŸ“å®ç°ï¼ŒåŒ…æ‹¬ç¼“å†²åŒºã€ç€è‰²å™¨ã€é¡¶ç‚¹æ•°ç»„å¯¹è±¡ç®¡ç†
- **ç¬¬ä¸‰æ–¹ä¾èµ–**: xclogger (æ—¥å¿—åº“), xcmath (æ•°å­¦åº“)

### ç»§æ‰¿ç»“æ„
```
AbsMObject (æŠ½è±¡åŸºç±»)
  â””â”€â”€ MObject (åŸºç¡€å›¾å½¢å¯¹è±¡)
       â”œâ”€â”€ Circle
       â”œâ”€â”€ Rectangle  
       â”œâ”€â”€ Line
       â”œâ”€â”€ Polygon
       â”œâ”€â”€ Ellipse
       â””â”€â”€ Path
```

### å±æ€§ç³»ç»Ÿæ¶æ„
```
MProperty (å±æ€§åŸºç±»)
  â”œâ”€â”€ Position (ä½ç½®å±æ€§)
  â”œâ”€â”€ Color (é¢œè‰²å±æ€§)
  â”œâ”€â”€ Scalar (æ ‡é‡å±æ€§)
  â”œâ”€â”€ TimeDuration (æ—¶é—´æ®µå±æ€§)
  â”œâ”€â”€ TimePoint (æ—¶é—´ç‚¹å±æ€§)
  â””â”€â”€ Vec (å‘é‡å±æ€§)
```

## æ„å»ºæŒ‡å—

### ä½¿ç”¨ CMake é¢„è®¾
é¡¹ç›®æä¾›äº†é¢„é…ç½®çš„ CMake é¢„è®¾ï¼š

```bash
# é…ç½®é¡¹ç›® (Debug æ¨¡å¼)
cmake -B build/debug -S . --preset build-debug

# é…ç½®é¡¹ç›® (Release æ¨¡å¼)  
cmake -B build/release -S . --preset build-release

# æ„å»ºé¡¹ç›®
cmake --build build/debug
```

### å¯ç”¨é¢„è®¾
- `build-debug`: Debug æ„å»ºé…ç½®
- `build-release`: Release æ„å»ºé…ç½®
- `clang-cl-build`: åŸºç¡€ Clang-cl é…ç½®

### è¿è¡Œæµ‹è¯•
```bash
# æ„å»ºæ‰€æœ‰æµ‹è¯•
cmake --build build/debug --target test_mobject test_properties test_scene test_opengl test_camera

# ä½¿ç”¨ CTest è¿è¡Œæ‰€æœ‰æµ‹è¯•
ctest --test-dir build/debug --output-on-failure

# ä½¿ç”¨ CTest è¿è¡Œç‰¹å®šæµ‹è¯•
ctest --test-dir build/debug -R test_mobject --output-on-failure

# ä½¿ç”¨ CTest æŸ¥çœ‹æµ‹è¯•åˆ—è¡¨
ctest --test-dir build/debug -N

# ä½¿ç”¨ CTest å¹¶è¡Œè¿è¡Œæµ‹è¯•
ctest --test-dir build/debug -j4 --output-on-failure

# ç›´æ¥è¿è¡Œç‰¹å®šæµ‹è¯•å¯æ‰§è¡Œæ–‡ä»¶
./build/debug/tests/test_opengl --gtest_filter="TestCircle.*"
```

**æ³¨æ„**: é¦–æ¬¡å¯ç”¨ CTest æˆ–æ·»åŠ æ–°æµ‹è¯•åï¼Œéœ€è¦é‡æ–°é…ç½®å’Œæ„å»ºé¡¹ç›®ï¼š
```bash
# é‡æ–°é…ç½®é¡¹ç›®
cmake -B build/debug -S . --preset build-debug

# æ„å»ºæ‰€æœ‰æµ‹è¯•
cmake --build build/debug --target test_mobject test_properties test_scene test_opengl test_camera

# ç„¶åå°±å¯ä»¥ä½¿ç”¨ CTest äº†
ctest --test-dir build/debug --output-on-failure
```

## ä»£ç é£æ ¼

### æ ¼å¼åŒ–å·¥å…·
é¡¹ç›®ä½¿ç”¨ `.clang-format` è¿›è¡Œä»£ç æ ¼å¼åŒ–ï¼ŒåŸºäº Google é£æ ¼ï¼Œç¼©è¿›ä¸º 4 ä¸ªç©ºæ ¼ã€‚é¡¹ç›®æä¾›äº† CMake ç›®æ ‡æ¥è‡ªåŠ¨æ ¼å¼åŒ–ä»£ç ï¼š

```bash
cmake --build build --target format-code
```

### å‘½åçº¦å®š
é¡¹ç›®éµå¾ª Google C++ é£æ ¼æŒ‡å—ï¼š
- **ç±»å**: PascalCase (å¦‚ `MObject`, `Scene`)
- **å‡½æ•°å**: snake_case (å¦‚ `set_stroke_color`, `rotate`) 
- **å˜é‡å**: snake_case (å¦‚ `position_list`, `color_value`)
- **ç§æœ‰æˆå‘˜å˜é‡**: snake_case_
- **å¸¸é‡å**: UPPER_SNAKE_CASE (å¦‚ `MAX_OBJECTS`, `DEFAULT_COLOR`)
- **ç¼–è¯‘æœŸå¸¸é‡å**: kPascalCase (å¦‚ `kTypeName`, `kEnumString`)

### å¤´æ–‡ä»¶ç»„ç»‡
- ä½¿ç”¨ `#pragma once` é˜²æ­¢é‡å¤åŒ…å«
- å¤´æ–‡ä»¶æŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡åœ¨ç›¸åº”ç›®å½•ä¸­

## æäº¤è´¡çŒ®æµç¨‹

### Git å·¥ä½œæµ
1. Fork æœ¬ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯: `git checkout -b feature/your-feature-name`
3. æäº¤æ›´æ”¹: `git commit -m "feat: add your feature"`
4. æ¨é€åˆ°åˆ†æ”¯: `git push origin feature/your-feature-name`
5. åˆ›å»º Pull Request

### æäº¤ä¿¡æ¯è§„èŒƒ
ä½¿ç”¨çº¦å®šå¼æäº¤æ ¼å¼ï¼š

- `feat`: æ–°åŠŸèƒ½
- `fix`: bug ä¿®å¤
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼è°ƒæ•´
- `refactor`: ä»£ç é‡æ„
- `test`: æµ‹è¯•ç›¸å…³
- `chore`: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·å˜åŠ¨

ç¤ºä¾‹: `feat(mobject): add circle object implementation`

### Pull Request è¦æ±‚
- åŒ…å«æ¸…æ™°çš„æè¿°å’Œä¿®æ”¹ç›®çš„
- é€šè¿‡æ‰€æœ‰ CI æ£€æŸ¥
- åŒ…å«ç›¸åº”çš„æµ‹è¯•ç”¨ä¾‹
- æ›´æ–°ç›¸å…³æ–‡æ¡£

## æµ‹è¯•è¦æ±‚

### å•å…ƒæµ‹è¯•
- ä¸ºæ‰€æœ‰æ–°åŠŸèƒ½ç¼–å†™å•å…ƒæµ‹è¯•
- æµ‹è¯•æ–‡ä»¶æ”¾åœ¨ `tests/` ç›®å½•ä¸‹
- ä½¿ç”¨ GTest æ¡†æ¶ç¼–å†™æµ‹è¯•

### æµ‹è¯•è¦†ç›–ç‡
ç¡®ä¿æ–°ä»£ç çš„æµ‹è¯•è¦†ç›–ç‡ä¸ä½äº 80%

### æµ‹è¯•è¿è¡Œ
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
ctest --preset build-debug

# è¿è¡Œç‰¹å®šæµ‹è¯•
./build-debug/tests/test_opengl --gtest_filter="TestScene.*"
```

## æ–‡æ¡£è¦æ±‚

### ä»£ç æ³¨é‡Š
- ä½¿ç”¨ Doxygen æ ¼å¼æ³¨é‡Šå…¬å…±æ¥å£
- ä¸ºå¤æ‚ç®—æ³•æ·»åŠ è¯¦ç»†æ³¨é‡Š
- ä¿æŒæ³¨é‡Šä¸ä»£ç åŒæ­¥æ›´æ–°

ç¤ºä¾‹:
```cpp
/**
 * @brief è®¡ç®—ä¸¤ä¸ªç‚¹çš„è·ç¦»
 * @param p1 ç¬¬ä¸€ä¸ªç‚¹
 * @param p2 ç¬¬äºŒä¸ªç‚¹  
 * @return ä¸¤ç‚¹ä¹‹é—´çš„æ¬§å‡ é‡Œå¾—è·ç¦»
 */
float_t calculateDistance(const Position& p1, const Position& p2);
```

### API æ–‡æ¡£
- æ‰€æœ‰å…¬å…±ç±»å’Œå‡½æ•°éƒ½éœ€è¦æ–‡æ¡£
- æ–‡æ¡£åº”è¯¥è¯´æ˜å‚æ•°ã€è¿”å›å€¼å’Œä½¿ç”¨ç¤ºä¾‹

## é—®é¢˜æŠ¥å‘Š

### Bug æŠ¥å‘Š
å½“æŠ¥å‘Š bug æ—¶ï¼Œè¯·åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š
1. é—®é¢˜æè¿°
2. é‡ç°æ­¥éª¤
3. æœŸæœ›è¡Œä¸º vs å®é™…è¡Œä¸º
4. ç¯å¢ƒä¿¡æ¯ (ç¼–è¯‘å™¨ç‰ˆæœ¬ã€æ“ä½œç³»ç»Ÿç­‰)
5. ç›¸å…³æ—¥å¿—è¾“å‡º

### åŠŸèƒ½è¯·æ±‚
æå‡ºæ–°åŠŸèƒ½æ—¶è¯·è¯´æ˜ï¼š
1. åŠŸèƒ½éœ€æ±‚æè¿°
2. ä½¿ç”¨åœºæ™¯
3. å¯èƒ½çš„å®ç°æ–¹æ¡ˆ
4. ç›¸å…³å‚è€ƒèµ„æ–™

## è”ç³»æ–¹å¼
å¦‚æœ‰é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- åˆ›å»º GitHub Issue
- é€šè¿‡ Pull Request è®¨è®º

æ„Ÿè°¢æ‚¨çš„è´¡çŒ®ï¼ğŸ‰

---

*æœ€åæ›´æ–°: 2025-09-04*
